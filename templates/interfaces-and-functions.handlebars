{{#*inline "inputInterfacePartial"}}
interface {{interfaceName}}Input {
  {{#each additionalProperties as |prop|}}
  {{prop}}
  {{/each}}
  {{#each columns}}
  "{{propertyName}}"{{#if optional}}?{{/if}}: {{propertyType}} {{#if nullable}}| null {{/if}}
  {{/each}}
}
{{/inline}}
{{#*inline "interfacePartial"}}
export interface {{interfaceName}} {
  {{#each additionalProperties as |prop|}}
  {{prop}}
  {{/each}}
  {{#each columns}}
  "{{propertyName}}": {{propertyType}} {{#if nullable}}| null {{/if}}
  {{/each}}
}
{{/inline}}
{{#*inline "funcGetAllFieldsPartial"}}
interface GetDataInput {
  client: Knex;
  where?: Partial<{{interfaceName}}>;
  whereRaw?: string;
  orderBy?: Array<
    keyof {{interfaceName}} | { column: keyof {{interfaceName}}; order?: "asc" | "desc" }
  >;
}
export async function get{{name}}AllFields({
  client,
  where,
  whereRaw,
  orderBy,
}: GetDataInput){
const query = client<{{interfaceName}}>("{{name}}");
  if (where) {
    query.where(where);
  }
  if (whereRaw) {
    query.whereRaw(whereRaw);
  }
  if (orderBy) {
    query.orderBy(orderBy);
  }
  return query;
}
{{/inline}}
{{#*inline "funcGetRequiredFieldsPartial"}}
export async function get{{name}}RequiredFields({
    client,
    where,
    whereRaw,
    orderBy,
  }: GetDataInput) {
  type Get{{name}}RequiredFieldsOutput = {
    {{#each columns}}
    {{#unless nullable}} 
    "{{propertyName}}": {{propertyType}}
    {{/unless}}
    {{/each}}
  }

  const query = client
  .from<{{interfaceName}}>("{{name}}")
  .select<Get{{name}}RequiredFieldsOutput[]>(
    {{#each columns}}
    {{#unless nullable}} 
    "{{propertyName}}",
    {{/unless}}
    {{/each}}
  )

  if (where) {
    query.where(where);
  }
  if (whereRaw) {
    query.whereRaw(whereRaw);
  }
  if (orderBy) {
    query.orderBy(orderBy);
  }
  return query;
}
{{/inline}}
{{#*inline "funcAddPartial"}}
interface AddFnInput {
  client: Knex;
  data: {{interfaceName}}Input;
}
export async function add{{name}} ( {client, data}: AddFnInput){
  return client<{{interfaceName}}>("{{name}}")
    .insert(data)
    .returning([
      {{#each columns}}
      "{{propertyName}}",
      {{/each}}
    ]);
}
{{/inline}}
{{#*inline "funcDeletePartial"}}
interface DeleteFnInput {
  client: Knex;
  where?: Partial<{{interfaceName}}>;
  whereRaw?: string;
}
export async function delete{{name}} ( {client, where, whereRaw}: DeleteFnInput){
  const query = client<{{interfaceName}}>("{{name}}")
    
  if(where){
    query.where(where);
  }  
  if (whereRaw) {
    query.whereRaw(whereRaw);
  }

  return query.del();
}
{{/inline}}
{{#*inline "funcUpdatePartial"}}
interface UpdateFnInput {
  client: Knex;
  data: Partial<{{interfaceName}}Input>;
  where?: Partial<{{interfaceName}}>;
  whereRaw?: string;
}
export async function update{{name}} ({client, data, where, whereRaw}: UpdateFnInput) {
  const query = client<{{interfaceName}}>("{{name}}");
  
  if(where){
    query.where(where);
  }  
  if (whereRaw) {
    query.whereRaw(whereRaw);
  }

  return query.update(data);
}
{{/inline}}
{{#*inline "funcBatchInsertPartial"}}
interface BatchInsertFnInput {
  client: Knex;
  data: {{interfaceName}}Input[];
}
export async function batchInsert{{name}}({client, data}: BatchInsertFnInput) {
  return client.batchInsert("{{name}}", data);
}
{{/inline}}
/* eslint-disable @typescript-eslint/camelcase */
/* eslint-disable @typescript-eslint/class-name-casing */
/*
* This file was generated by a tool.
* Rerun sql-ts to regenerate this file.
*/

import { Knex } from "knex";

{{#if config.tableAsNamespace}}
{{#each grouped.dbo.tables as |table|}}
export namespace {{table.name}} {
  {{> inputInterfacePartial table}}  
  {{> interfacePartial table}}
  {{> funcGetAllFieldsPartial table}}
  {{> funcGetRequiredFieldsPartial table}}
  {{> funcAddPartial table}}
  {{> funcDeletePartial table}}
  {{> funcUpdatePartial table}}
  {{> funcBatchInsertPartial table}}
{{/each}}
}
{{else}}
{{#each grouped.dbo.tables as |table|}}
{{> inputInterfacePartial table}}
{{> interfacePartial table}}
{{> funcGetAllFieldsPartial table}}
{{> funcGetRequiredFieldsPartial table}}
{{> funcAddPartial table}}
{{> funcDeletePartial table}}
{{> funcUpdatePartial table}}
{{> funcBatchInsertPartial table}}
{{/each}}
{{/if}}